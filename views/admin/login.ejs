<%- include('../partials/header', {title: 'Admin Login'}) %>
    <body>
        <div class="container">
            <h1>Admin Login</h1>
            <div id="error" class="error" style="display: none"></div>
            <form>
                <input
                    type="text"
                    id="username"
                    placeholder="Username"
                    required
                />
                <input
                    type="password"
                    id="password"
                    placeholder="Password"
                    required
                />
                <button onclick="login()" id="loginBtn">Login</button>
            </form>
        </div>


<%- include('../partials/footer', {extraScripts: `
        <script>
            async function login() {
                const btn = document.getElementById("loginBtn");
                const errorDiv = document.getElementById("error");

                btn.disabled = true;
                btn.innerText = "Logging in...";

                try {
                    const username = document.getElementById("username").value;
                    const password = document.getElementById("password").value;

                    const res = await axios.post("/admin/login", {
                        username,
                        password,
                    });

                    if (res.data.success) {
                        window.location.href = "/admin/dashboard";
                    } else {
                        errorDiv.innerText =
                            res.data.message || "Login failed.";
                        errorDiv.style.display = "block";
                        btn.disabled = false;
                        btn.innerText = "Login";
                    }
                } catch (err) {
                    errorDiv.innerText = "An error occurred. Try again.";
                    errorDiv.style.display = "block";
                    btn.disabled = false;
                    btn.innerText = "Login";
                }
            }
        </script>
    `}) %>
